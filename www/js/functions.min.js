var sourceURL="http://universeos.org";var usernames=[];var realnames=[];var userPictures=[];var loadedMessages=[];var sendedMessagesContent=[];var lastMessageReceived=0;var unseenMessages=0;var openChatDialoges=[];var messageKeys=[];var privateKeys=[];var shownUsers=[];var delay=(function(){var a=0;return function(c,b){clearTimeout(a);a=setTimeout(c,b)}})();function initApp(){$(document).ready(function(){if(isLogin()){$("#offline").hide();init.search();$("#storeMessageKeys").prop("checked",eval(localStorage.config_storeMessageKeys));$("#loader").show();getBuddylist(true,true);showBuddylist();getOpenRequests();reload()}else{$("#online").hide();$("#offline").show();$("#start").show()}$("#openReg").click(function(){$(".captcha").attr("src",sourceURL+"/inc/plugins/captcha/image.php?dummy="+new Date().getTime());showRegistration()});$("#regBack").click(function(){showLogin()});$("#loginForm").submit(function(){login();event.preventDefault()});$("#regUsername").keyup(function(){delay(function(){checkUsername("regUsername")},500)});$("#regForm").submit(function(){checkReg();event.preventDefault()})})}var app={initialize:function(){initApp();this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,false)},onDeviceReady:function(){}};app.initialize();var hash=new function(){this.MD5=function(a){var b=CryptoJS.MD5(a);return b.toString(CryptoJS.enc.Hex)};this.SHA512=function(a){var b=CryptoJS.SHA512(a);return b.toString(CryptoJS.enc.Hex)}};function reload(){var a=[];a.messages=3000;a.buddyRequests=180000;a.buddylist=60000;setInterval(function(){reloadDialoges()},a.messages);getOpenRequests();setInterval(function(){getOpenRequests()},a.buddyRequests);setInterval(function(){getBuddies()},a.buddylist)}function updateConfig(a,c){if(a==="storeMessageKeys"){if(c===true){localStorage.storedMessageKeys=JSON.stringify(messageKeys)}else{if(c===false){if(localStorage.storedMessageKeys){var b=$.parseJSON(localStorage.storedMessageKeys);messageKeys=b}}}localStorage.config_storeMessageKeys=c}return true}function jsAlert(b,c){var a;if(empty(b)){a="alert-info"}else{if(b=="success"){a="alert-success"}else{if(b=="error"){a="alert-error"}}}$("#alerter").append('<div class="alert '+a+'"><button type="button" class="close" data-dismiss="alert">&times;</button>'+c+"</div>");$(".alert").delay(5000).fadeOut(function(){$(this).remove()})}function symEncrypt(b,c){var d;var a;d=CryptoJS.AES.encrypt(c,b);return String(d)}function symDecrypt(b,c){var d;d=CryptoJS.AES.decrypt(c,b);var a=CryptoJS.enc.Utf8.stringify(d);return String(a)}function generateAsymKeyPair(){var b=1024;var c;var a=[];c=new JSEncrypt({default_key_size:b});c.getKey();a.privateKey=c.getPrivateKey();a.publicKey=c.getPublicKey();return a}function getPrivateKey(e,f,c){var g;var d=e+"_"+f;if(typeof privateKeys[d]==="undefined"){console.log(d);var b="";$.ajax({url:sourceURL+"/api.php?action=getPrivateKey",async:false,type:"POST",data:{type:e,itemId:f},success:function(j){b=j}});var i=localStorage.currentUser_passwordHashMD5;var h=CryptoJS.SHA512(i+c);var a=h.toString(CryptoJS.enc.Hex);g=symDecrypt(a,b);privateKeys[d]=g}else{g=privateKeys[d]}return g}function getSalt(d,e,c){var b="";$.ajax({url:sourceURL+"/api.php?action=getSalt",async:false,type:"POST",data:{type:d,itemId:e},success:function(f){b=f}});var a=symDecrypt(c,b);return a}function getPublicKey(b,c){var a="";$.ajax({url:sourceURL+"/api.php?action=getPublicKey",async:false,type:"POST",data:{type:b,itemId:c},success:function(d){a=d}});return a}function asymEncrypt(c,a){var b=new JSEncrypt();b.setPublicKey(c);return b.encrypt(a)}function asymDecrypt(a,c){var d;var b=new JSEncrypt();b.setPrivateKey(a);d=b.decrypt(c);console.log(d);return d}function searchUserByString(c,b){var a=[];$.ajax({url:sourceURL+"/api.php?action=searchUserByString",async:false,type:"POST",data:{string:c,limit:b},success:function(e){var d=JSON.parse(e);if(d.length!==0){$(".buddylist").hide();$("#openRequests").hide();$("#searchResult").show();$.each(d,function(f,j){if($("#searchResult_"+String(f)).length==0){var k=j[0];var i=j[1];var h=getUserPicture(f);var g="";if($("#buddy_"+String(f)).length==0){g='<a href="#" onclick="sendFriendRequest(\''+f+'\');" class="btn btn-success pull-right" id="requestButton_'+f+'">add</a>'}$("#searchResult").append('<li id="searchResult_'+String(f)+'"><div class="userPicture" style="background: url('+h+');"></div><span class="username">'+k+'</span><br /><span class="realname">'+i+"</span>"+g+"</li>")}})}}});return a}function showLogin(){$("#login").slideDown();$("#reg").hide();$("#waitWhileKey").hide()}function showRegistration(){$("#login").show();$("#reg").slideDown()}function checkUsername(b){var a=$("#"+b).val();if(/^[a-zA-Z0-9- ]*$/.test(a)===false){$("#checkUsernameStatus").html('<a style="color: red">&nbsp;contains illegal characters</a>')}else{if(a.length>2){$.post(sourceURL+"/api.php?action=checkUsername",{username:a},function(c){var d=c;if(d==="1"){$("#checkUsernameStatus").html('<a style="color: green">&nbsp;succes!</a>')}else{$("#checkUsernameStatus").html('<a style="color: red">&nbsp;already in use</a>')}},"html")}else{$("#checkUsernameStatus").html('<o style="color: red">&nbsp;to short</o>')}}}function checkReg(){var d;var b;var c;var a;var e;$(".checkReg").each(function(){d=$(this).val();if(d===""){b="FALSE"}else{if(b===""){b="TRUE"}}});if($("#regUsername").val().length<3){e="FALSE"}$(".checkRegBox").each(function(){c=$(this).is(":checked");if(c){c="TRUE"}else{c="FALSE"}});if($("#reg #regPassword").val()!==$("#reg #regRepeatPassword").val()){a="FALSE"}if(b==="FALSE"||a==="FALSE"||c==="FALSE"||e==="FALSE"){if(b==="FALSE"){jsAlert("","Please fill out all the fields")}if(e==="FALSE"){jsAlert("","Your Username needs at least three chars.")}if(c==="FALSE"){jsAlert("","Your have to accept our terms.")}if(a==="FALSE"){jsAlert("","Your passwords dont match.")}}else{processRegistration()}}function processRegistration(){var b=$("#reg #regUsername").val();var h=$("#reg #regPassword").val();var j=hash.MD5(h);var c=hash.SHA512(randomString(64,"#aA"));var f=hash.SHA512(c+j);var a=hash.SHA512(j+c);var c=symEncrypt(j,c);var e=$("#reg #regPassword").val();var i;var d;var g;i=new JSEncrypt({default_key_size:4096});$("#reg").hide();$("#waitWhileKey").show();i.getKey(function(){g=symEncrypt(a,i.getPrivateKey());d=i.getPublicKey();$.post(sourceURL+"/api.php?action=processSiteRegistrationMobile",{username:b,password:f,salt:c,publicKey:d,privateKey:g},function(k){var l=k;if(l==1){jsAlert("","You just joined the universeOS");$("#username").val(b);$("#password").val(e);showLogin()}else{jsAlert("",l)}},"html")})}function login(){var f=$("#login #username").val();var d=$("#login #password").val();var c=usernameToUserid(f);var b=hash.MD5(d);var e=getSalt("auth",c,b);var a=hash.SHA512(e+b);$.post(sourceURL+"/api.php?action=authentificate",{username:f,password:a},function(g){var h=g;if(h==1){localStorage.currentUser_userid=c;localStorage.currentUser_username=f;localStorage.currentUser_passwordHash=a;localStorage.currentUser_passwordHashMD5=b;$("#offline").hide();$("#loader").show();$("#buddylistFrame").show();$("#online").show();getBuddylist();showBuddylist();reload()}else{jsAlert("",h)}},"html")}function logout(){delete localStorage.currentUser_userid;delete localStorage.currentUser_username;delete localStorage.currentUser_passwordHash;window.location.href="index.html";initApp()}function isLogin(){var a=localStorage.currentUser_userid;if(a){return true}else{return false}}function useridToUsername(b){if(usernames[b]==undefined){var a="";$.ajax({url:sourceURL+"/api.php?action=useridToUsername",async:false,type:"POST",data:{userid:b},success:function(c){a=c}});usernames[b]=a;return a}else{return htmlentities(usernames[b])}}function useridToRealname(b){if(realnames[b]==undefined){var a="";$.ajax({url:sourceURL+"/api.php?action=useridToRealname",async:false,type:"POST",data:{userid:b},success:function(c){a=c}});realnames[b]=a;return a}else{return htmlentities(realnames[b])}}function usernameToUserid(b){var a="";$.ajax({url:sourceURL+"/api.php?action=usernameToUserid",async:false,type:"POST",data:{username:b},success:function(c){a=c}});usernames[a]=b;return a}function getLastActivity(b){var a="";$.ajax({url:sourceURL+"/api.php?action=getLastActivity",async:false,type:"POST",data:{userid:b},success:function(c){a=c}});return parseInt(a)}function getUserPicture(b){var a="";$.ajax({url:sourceURL+"/api.php?action=getUserPicture",async:false,type:"POST",data:{userid:b},success:function(c){a=c}});userPictures[b]=a;return htmlentities(a)}function showUserPicture(a){var c=getUserPicture(a);var d=getLastActivity(a);var b;b='<div class="userPicture userPicture_'+a+'" style="background: url(\''+c+"'); "+getUserBorder(d)+'"></div>';$(".userPicture_"+a).css("border",getUserBorder(d));return b}function getUserBorder(b){var a;if(b===1){a="border-color: green"}else{a="border-color: red"}return a}function changeMainIconToUserpicture(a){var b=showUserPicture(a);$(".navbar-brand").html(b)}function mainIconToDefault(){$(".navbar-brand").html('<img src="img/logo.png" alt="logo" id="logo"/>')}function denyFriendRequest(a){$.ajax({url:sourceURL+"/api.php?action=denyFriendRequest",async:false,type:"POST",data:{userid:localStorage.currentUser_userid,hash:localStorage.currentUser_passwordHash,buddy:a},success:function(b){jsAlert("","The request has been removed.");$("#openRequest_"+a).hide();$("#openRequest_"+a).remove()}})}function replyFriendRequest(a){$.ajax({url:sourceURL+"/api.php?action=replyFriendRequest",async:false,type:"POST",data:{userid:localStorage.currentUser_userid,hash:localStorage.currentUser_passwordHash,buddy:a},success:function(b){jsAlert("","The user has been added to your buddylist.");$("#openRequest_"+a).hide();$("#openRequest_"+a).remove()}})}function sendFriendRequest(a){$.ajax({url:sourceURL+"/api.php?action=addBuddy",async:false,type:"POST",data:{userid:localStorage.currentUser_userid,hash:localStorage.currentUser_passwordHash,buddy:a},success:function(b){if(b==1){jsAlert("","Your request has been send");$("#requestButton_"+a).attr("onclick","");$("#requestButton_"+a).attr("disabled","disabled")}else{jsAlert("","The request couldn'nt been send.")}}})}function getOpenRequests(){var a=[];$.post(sourceURL+"/api.php?action=getOpenRequests",{userid:localStorage.currentUser_userid,hash:localStorage.currentUser_passwordHash},function(b){if(b!=="null"){a=JSON.parse(b);$.each(a,function(c,f){if(!$("#openRequest_"+c).length){var g=f;var e=useridToRealname(c);var d=showUserPicture(c);$("#openRequests").append('<li id="openRequest_'+c+'">'+d+'<span class="username">'+g+'</span><br /><span class="realname">'+e+' wants to be your friend</span></div><a href="#" onclick="denyFriendRequest(\''+c+'\');" class="btn btn-danger pull-right" style="margin-left: 5px;" id="denyRequestButton_'+c+'">decline</a><a href="#" onclick="replyFriendRequest(\''+c+'\');" class="btn btn-success pull-right" id="replyRequestButton_'+c+'">add</a></li>')}})}},"html")}function getBuddies(a,c){var b=[];$.post(sourceURL+"/api.php?action=getBuddylist",{userid:localStorage.currentUser_userid,hash:localStorage.currentUser_passwordHash},function(d){if(d!=="null"){b=JSON.parse(d);var e=0;$.each(b,function(g,j){var l=useridToUsername(j);var i=useridToRealname(j);var h=showUserPicture(j);var k=getLastActivity(j);var f=false;if(typeof(shownUsers[j])=="undefined"){shownUsers[j]=k;if(k===1){$(".buddylist#onlineList").append('<li id="buddy_'+j+'" onclick="showDialoge(\''+j+"')\">"+h+'<a href="#" onclick="showDialoge(\''+j+'\')"><span class="username">'+l+'</span><br /><span class="realname">'+i+"</span></a></li>")}else{$(".buddylist#offlineList").append('<li id="buddy_'+j+'" onclick="showDialoge(\''+j+"')\">"+h+'<a href="#" onclick="showDialoge(\''+j+'\')"><span class="username">'+l+'</span><br /><span class="realname">'+i+"</span></a></li>")}}else{if(k!=shownUsers[j]){if(k===1){$("#buddy_"+j).remove();$(".buddylist#onlineList").append('<li id="buddy_'+j+'" onclick="showDialoge(\''+j+"')\">"+h+'<a href="#" onclick="showDialoge(\''+j+'\')"><span class="username">'+l+'</span><br /><span class="realname">'+i+"</span></a></li>")}else{$("#buddy_"+j).remove();$(".buddylist#offlineList").append('<li id="buddy_'+j+'" onclick="showDialoge(\''+j+"')\">"+h+'<a href="#" onclick="showDialoge(\''+j+'\')"><span class="username">'+l+'</span><br /><span class="realname">'+i+"</span></a></li>")}}}e++;if(e===b.length){if(f){showBuddylist()}$("#loader").remove()}})}},"html")}function getBuddylist(a,b){$("#online").show();getBuddies(a,b)}function reload(){var a=[];a.messages=3000;a.buddyRequests=180000;a.buddylist=60000;setInterval(function(){reloadDialoges()},a.messages);getOpenRequests();setInterval(function(){getOpenRequests()},a.buddyRequests);setInterval(function(){getBuddies()},a.buddylist)}function storeMessageKeyInLocalStorage(c,a){if(localStorage.storedMessageKeys){var b=$.parseJSON(localStorage.storedMessageKeys)}else{var b=[]}b[c]=a;localStorage.storedMessageKeys=JSON.stringify(b)}function storeMessageKey(a,b){if(localStorage.config_storeMessageKeys=="true"){storeMessageKeyInLocalStorage(a,b)}else{messageKeys[a]=b}}function getStoredKey(b){var a;if(localStorage.config_storeMessageKeys=="true"){var c=$.parseJSON(localStorage.storedMessageKeys);a=c[b]}else{a=messageKeys[b]}return a}function isStored(a){if(localStorage.config_storeMessageKeys=="true"){var b=$.parseJSON(localStorage.storedMessageKeys);if(b[a]){return true}else{return false}}else{if(messageKeys[a]!==undefined){return true}else{return false}}}function chatSubmitMessage(e){var d=$("#chatInput_"+e).val();var f=getPublicKey("user",e);var b=Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);var c=symEncrypt(b,d);var a=asymEncrypt(f,b);var c=a+"////message////"+c;$.post(sourceURL+"/api.php?action=chatSendMessage",{userid:localStorage.currentUser_userid,hash:localStorage.currentUser_passwordHash,receiver:e,message:c},function(g){var h=g;if(h.length!==0){storeMessageKey(h,b);$("#chatInput_"+e).val("");loadDialoge(e,"0,25");$("#chatInput_"+e).focus()}else{jsAlert("","There was an error sending the message.")}},"html");console.log(c)}function updateUnseenMessages(a){$("#unseenMessages").hide();if(a!==0){$("#unseenMessages").html(a);$("#unseenMessages").show()}else{$("#unseenMessages").html("")}}function markMessageAsRead(a){$.post(sourceURL+"/api.php?action=markMessageAsRead",{userid:localStorage.currentUser_userid,hash:localStorage.currentUser_passwordHash,buddy:a},function(b){},"html");$("#overview_"+a).removeClass("unseen")}function reloadDialoges(){$("#online").show();console.log("check server for messages...");$.post(sourceURL+"/api.php?action=getLastMessage",{userid:localStorage.currentUser_userid,hash:localStorage.currentUser_passwordHash},function(a){if(lastMessageReceived!==a&&a.length>0){console.log("need to update messages..."+lastMessageReceived+"::"+a);$.post(sourceURL+"/api.php?action=getUnseenMessageAuthors",{userid:localStorage.currentUser_userid,hash:localStorage.currentUser_passwordHash},function(b){if(b!==null){var c=JSON.parse(b);$.each(c,function(e,d){loadDialoge(d,"0,25")})}},"html")}},"html")}function loadDialoge(b,a){console.log("load dialoge");$.ajax({url:sourceURL+"/api.php?action=chatGetMessages",async:false,type:"POST",data:{userid:localStorage.currentUser_userid,hash:localStorage.currentUser_passwordHash,receiver:b,limit:a},success:function(d){var c;if(d!=="null"){c=JSON.parse(d);$.each(c,function(h,l){if(loadedMessages[h]===undefined){var o;var f=l.text;var i;var j;if(l.sender===localStorage.currentUser_userid){console.log("load message from user");i="outgoing";j=l.receiver;o=localStorage.currentUser_username;if(isStored(h)){var f=f.split("////message////");var f=symDecrypt(getStoredKey(h),f[1]);console.log(f)}else{f="Key is not saved, written message can not be encrypted anymore"}}else{console.log("load message from buddy");i="incoming";j=l.sender;o=useridToUsername(j);var g=getSalt("auth",localStorage.currentUser_userid,localStorage.currentUser_passwordHashMD5);var m=getPrivateKey("user",localStorage.currentUser_userid,g);var f=l.text;var f=f.split("////message////");if(f[0]!==null&&f[1]!==null){var n=asymDecrypt(m,f[0]);if(n!==null){var f=symDecrypt(n,f[1])}}}var e=new Date(l.timestamp*1000);var k=e.getHours()+":"+e.getMinutes();openDialoge(j);var f=htmlentities(f);if($("#chatWindow_"+j).filter(":visible").length===0&&l.read==="0"&&i==="incoming"){unseenMessages++;updateUnseenMessages(unseenMessages);$("#overview_"+j).addClass("unseen");$("#lastMessage_"+j).html(f)}else{if($("#chatWindow_"+j).filter(":visible").length===1&&l.read==="0"&&i==="incoming"){markMessageAsRead(j)}}$("#messageFrame_"+b).prepend('<li class="'+i+'"><header>'+o+" - "+k+"</header><div>"+f+"</div></footer></li>");loadedMessages[h]=true;if(lastMessageReceived<h){lastMessageReceived=h}}})}}})}function appendMessagesToDialoge(){}function openDialoge(a){console.log("open dialoge...");if(!$("#chatWindow_"+a).length){var c=useridToUsername(a);var b=showUserPicture(a);$("#chatOverview").append('<li id="overview_'+a+'" onclick="showDialoge(\''+a+"')\">"+b+'<a href="#"><span class="username">'+c+'</span><br /><span class="lastMessage" id="lastMessage_'+a+'"></span></a></li>');$("#chatWindows").append('<div class="chatWindow mainFrame" id="chatWindow_'+a+'"><header>'+c+'</header><ul class="messageFrame" id="messageFrame_'+a+'"></ul><footer><form id="chatForm_'+a+'"><div><input type="text" id="chatInput_'+a+'" class="chatInput" placeholder="please type a message"></div><div><input type="submit" class="btn btn-success btn-sm" value="SEND"></div></form></footer></div>');$("#chatForm_"+a).submit(function(){console.log("send message");event.preventDefault();chatSubmitMessage(a)});loadDialoge(a,"0,25");openChatDialoges[a]=true}}function showDialoge(a){$("#unseenMessages").html();console.log("show dialoge for user "+a+"...");$(".navbar-nav li").removeClass("active");$("#overviewNav").addClass("active");if(!$("#chatWindow_"+a).length){console.log("no dialoge exisiting...");openDialoge(a)}$(".mainFrame").hide();$("#chatWindows").show();$(".chatWindow").hide();$("#chatWindow_"+a).show();markMessageAsRead(a);changeMainIconToUserpicture(a)}function showBuddylist(){init.search();$(".navbar-nav li").removeClass("active");$("#buddylistNav").addClass("active");mainIconToDefault();$("#chatWindows").hide();$(".mainFrame").hide();$("#buddylistFrame").show();$(".buddylist").show()}function showOverview(){unseenMessages=0;$("#unseenMessages").html("");mainIconToDefault();$(".navbar-nav li").removeClass("active");$("#overviewNav").addClass("active");$("#chatWindows").hide();$(".mainFrame").hide();$("#chatOverviewFrame").slideDown()}var init=new function(){this.search=function(){$("#search").on("input",function(){if($("#search").val()){$("#searchResult").html("");searchUserByString($("#search").val(),"0,10")}else{$(".buddylist").show();$("#openRequests").show();$("#searchResult").hide()}});$("#searchForm").submit(function(a){a.preventDefault()})}};function htmlentities(b,f,e,a){var d=this.get_html_translation_table("HTML_ENTITIES",f),c="";b=b==null?"":b+"";if(!d){return false}if(f&&f==="ENT_QUOTES"){d["'"]="&#039;"}if(!!a||a==null){for(c in d){if(d.hasOwnProperty(c)){b=b.split(c).join(d[c])}}}else{b=b.replace(/([\s\S]*?)(&(?:#\d+|#x[\da-f]+|[a-zA-Z][\da-z]*);|$)/g,function(i,h,g){for(c in d){if(d.hasOwnProperty(c)){h=h.split(c).join(d[c])}}return h+g})}return b}function get_html_translation_table(h,f){var c={},e={},b;var d={},a={};var i={},g={};d[0]="HTML_SPECIALCHARS";d[1]="HTML_ENTITIES";a[0]="ENT_NOQUOTES";a[2]="ENT_COMPAT";a[3]="ENT_QUOTES";i=!isNaN(h)?d[h]:h?h.toUpperCase():"HTML_SPECIALCHARS";g=!isNaN(f)?a[f]:f?f.toUpperCase():"ENT_COMPAT";if(i!=="HTML_SPECIALCHARS"&&i!=="HTML_ENTITIES"){throw new Error("Table: "+i+" not supported")}c["38"]="&amp;";if(i==="HTML_ENTITIES"){c["160"]="&nbsp;";c["161"]="&iexcl;";c["162"]="&cent;";c["163"]="&pound;";c["164"]="&curren;";c["165"]="&yen;";c["166"]="&brvbar;";c["167"]="&sect;";c["168"]="&uml;";c["169"]="&copy;";c["170"]="&ordf;";c["171"]="&laquo;";c["172"]="&not;";c["173"]="&shy;";c["174"]="&reg;";c["175"]="&macr;";c["176"]="&deg;";c["177"]="&plusmn;";c["178"]="&sup2;";c["179"]="&sup3;";c["180"]="&acute;";c["181"]="&micro;";c["182"]="&para;";c["183"]="&middot;";c["184"]="&cedil;";c["185"]="&sup1;";c["186"]="&ordm;";c["187"]="&raquo;";c["188"]="&frac14;";c["189"]="&frac12;";c["190"]="&frac34;";c["191"]="&iquest;";c["192"]="&Agrave;";c["193"]="&Aacute;";c["194"]="&Acirc;";c["195"]="&Atilde;";c["196"]="&Auml;";c["197"]="&Aring;";c["198"]="&AElig;";c["199"]="&Ccedil;";c["200"]="&Egrave;";c["201"]="&Eacute;";c["202"]="&Ecirc;";c["203"]="&Euml;";c["204"]="&Igrave;";c["205"]="&Iacute;";c["206"]="&Icirc;";c["207"]="&Iuml;";c["208"]="&ETH;";c["209"]="&Ntilde;";c["210"]="&Ograve;";c["211"]="&Oacute;";c["212"]="&Ocirc;";c["213"]="&Otilde;";c["214"]="&Ouml;";c["215"]="&times;";c["216"]="&Oslash;";c["217"]="&Ugrave;";c["218"]="&Uacute;";c["219"]="&Ucirc;";c["220"]="&Uuml;";c["221"]="&Yacute;";c["222"]="&THORN;";c["223"]="&szlig;";c["224"]="&agrave;";c["225"]="&aacute;";c["226"]="&acirc;";c["227"]="&atilde;";c["228"]="&auml;";c["229"]="&aring;";c["230"]="&aelig;";c["231"]="&ccedil;";c["232"]="&egrave;";c["233"]="&eacute;";c["234"]="&ecirc;";c["235"]="&euml;";c["236"]="&igrave;";c["237"]="&iacute;";c["238"]="&icirc;";c["239"]="&iuml;";c["240"]="&eth;";c["241"]="&ntilde;";c["242"]="&ograve;";c["243"]="&oacute;";c["244"]="&ocirc;";c["245"]="&otilde;";c["246"]="&ouml;";c["247"]="&divide;";c["248"]="&oslash;";c["249"]="&ugrave;";c["250"]="&uacute;";c["251"]="&ucirc;";c["252"]="&uuml;";c["253"]="&yacute;";c["254"]="&thorn;";c["255"]="&yuml;"}if(g!=="ENT_NOQUOTES"){c["34"]="&quot;"}if(g==="ENT_QUOTES"){c["39"]="&#39;"}c["60"]="&lt;";c["62"]="&gt;";for(b in c){if(c.hasOwnProperty(b)){e[String.fromCharCode(b)]=c[b]}}return e}function in_array(e,d,c){var b="",a=!!c;if(a){for(b in d){if(d[b]===e){return true}}}else{for(b in d){if(d[b]==e){return true}}}return false}function randomString(e,d){var b="";if(d.indexOf("a")>-1){b+="abcdefghijklmnopqrstuvwxyz"}if(d.indexOf("A")>-1){b+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"}if(d.indexOf("#")>-1){b+="0123456789"}if(d.indexOf("!")>-1){b+="~`!@#$%^&*()_+-={}[]:\";'<>?,./|\\"}var a="";for(var c=e;c>0;--c){a+=b[Math.round(Math.random()*(b.length-1))]}return a}function empty(a){if(a.length==0){return true}else{return false}};